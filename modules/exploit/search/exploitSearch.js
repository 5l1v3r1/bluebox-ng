/*
  Copyright Jesús Pérez <jesusprubio@gmail.com>
            Sergio García <s3rgio.gr@gmail.com>

  This code may only be used under the MIT license found at
  https://opensource.org/licenses/MIT.
*/

'use strict';

const search = require('exploitsearch');


module.exports.desc = 'Find vulnerabilities and exploit for an specifig' +
                      ' service version (using exploitsearch.net API).';


module.exports.opts = {
  query: {
    desc: 'String to search',
    default: 'Apache 7.4',
  },
  timeout: {
    types: 'natural',
    desc: 'Time to wait for a response (ms)',
    default: 5000,
  },
  onlyExploits: {
    types: 'bool',
    desc: 'Look only for exploits, not vulns',
    default: false,
  },
};


module.exports.impl = (opts = {}) =>
  search(opts.query, {
    timeout: opts.timeout,
    exploits: opts.exploitsOnly,
  });

