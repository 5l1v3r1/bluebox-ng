/*
  Copyright Jesús Pérez <jesusprubio@gmail.com>
            Sergio Garcia <s3rgio.gr gmail com>

  This code may only be used under the GPLv3 license found at
  http://www.gnu.org/licenses/gpl-3.0.txt.
*/

'use strict';

const search = require('../../../..').exploitSearch;


module.exports.desc = 'Find vulnerabilities and exploit for an specifig' +
                      ' service version (using exploitsearch.net API).';


module.exports.opts = {
  query: {
    desc: 'String to search',
    default: 'Apache 7.4',
  },
  timeout: {
    types: 'natural',
    desc: 'Time to wait for a response (ms)',
    default: 5000,
  },
  onlyExploits: {
    types: 'bool',
    desc: 'Look only for exploits, not vulns',
    default: false,
  },
};


module.exports.impl = opts => search(opts.query, opts);
